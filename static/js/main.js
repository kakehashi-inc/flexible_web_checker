(()=>{function e(e){let t=null;if(document.cookie&&""!==document.cookie){let n=document.cookie.split(";");for(let o=0;o<n.length;o++){let s=n[o].trim();if(s.substring(0,e.length+1)===e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}}return t}function t(e,t){let n=document.createElement("div");n.className=`alert alert-${t} fade-in`,n.textContent=e;let o=document.querySelector(".messages");o&&(o.appendChild(n),setTimeout(function(){n.style.opacity="0",n.style.transition="opacity 0.5s ease-in-out",setTimeout(function(){n.remove()},500)},5e3))}document.addEventListener("DOMContentLoaded",function(){let n=document.querySelectorAll(".messages > div");n.length>0&&setTimeout(function(){n.forEach(function(e){e.style.opacity="0",e.style.transition="opacity 0.5s ease-in-out",setTimeout(function(){e.remove()},500)})},5e3),document.querySelectorAll(".check-url-btn").forEach(function(n){n.addEventListener("click",function(n){n.preventDefault();let o=this.getAttribute("data-url"),s=this.innerHTML;this.disabled=!0,this.innerHTML='<span class="spinner"></span> チェック中...',fetch(o,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRFToken":e("csrftoken")}}).then(e=>e.json()).then(e=>{"success"===e.status?t("更新チェックを開始しました。","success"):t("エラーが発生しました。","error")}).catch(e=>{console.error("Error:",e),t("エラーが発生しました。","error")}).finally(()=>{this.disabled=!1,this.innerHTML=s})})}),document.querySelectorAll(".collection-url-btn").forEach(function(n){n.addEventListener("click",function(n){n.preventDefault();let o=this.getAttribute("data-url"),s=this.getAttribute("data-action");this.innerHTML,this.disabled=!0,fetch(o,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRFToken":e("csrftoken")}}).then(e=>e.json()).then(e=>{"success"===e.status?"add"===s?(t("URLをコレクションに追加しました。","success"),this.closest("tr").remove()):"remove"===s&&(t("URLをコレクションから削除しました。","success"),this.closest("tr").remove()):t("エラーが発生しました。","error")}).catch(e=>{console.error("Error:",e),t("エラーが発生しました。","error")}).finally(()=>{this.disabled=!1})})})}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("id_check_type"),t=document.getElementById("html-selector-field"),n=document.getElementById("html-condition-field");if(e&&t&&n){function o(){"HTML_CUSTOM"===e.value?(t.style.display="block",n.style.display="block"):(t.style.display="none",n.style.display="none")}o(),e.addEventListener("change",o)}})})();